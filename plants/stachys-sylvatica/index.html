<!DOCTYPE html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
<script>
  let xoff = 0;
  let yoff = 1000;
  let leafXoff = 5000;
  let flowerXoff = 8000;

  function setup() {
    createCanvas(450, 800);
    noFill();
    frameRate(30);
  }

  function draw() {
    background(255);
    translate(width / 2, height);

    let growth = map(frameCount, 0, 1000, 0, height / 1.5);
    drawStem(growth);
    drawLeaves(growth);
    drawFlowers(growth);

    if (frameCount >= 1000) {
      noLoop();
    }
  }

  function drawStem(len) {
    stroke(100, 200, 100);
    strokeWeight(2);
    beginShape();
    for (let y = 0; y > -len; y -= 10) {
      let x = noise(xoff) * 20 - 10;
      vertex(x, y);
      xoff += 0.05;
    }
    endShape();
    translate(0, -len);
  }

  function drawLeaves(growth) {
    if (growth > 50) {
      let leafSize = map(growth, 50, height / 1.5, 20, 100);

      for (let i = -1; i <= 1; i += 2) {
        push();
        rotate(i * 45);
        drawLeaf(leafSize);
        pop();
      }
    }
  }

  function drawLeaf(len) {
    stroke(34, 139, 34);
    strokeWeight(1.5);
    beginShape();
    for (let x = 0; x < len; x++) {
      let y = noise(leafXoff) * len / 2;
      vertex(x, y);
      leafXoff += 0.02;
    }
    for (let x = len; x > 0; x--) {
      let y = noise(leafXoff) * len / 2;
      vertex(x, -y);
      leafXoff += 0.02;
    }
    endShape(CLOSE);
  }

  function drawFlowers(growth) {
    if (growth > height / 2) {
      let flowerSize = map(growth, height / 2, height / 1.5, 20, 50);

      for (let i = 0; i < 360; i += 120) {
        push();
        rotate(i);
        drawFlower(flowerSize);
        pop();
      }
    }
  }

  function drawFlower(len) {
    stroke(200, 100, 150);
    strokeWeight(1.5);
    beginShape();
    for (let x = 0; x < len; x++) {
      let y = noise(flowerXoff) * len / 2;
      vertex(x, y);
      flowerXoff += 0.03;
    }
    for (let x = len; x > 0; x--) {
      let y = noise(flowerXoff) * len / 2;
      vertex(x, -y);
      flowerXoff += 0.03;
    }
    endShape(CLOSE);
  }
</script>